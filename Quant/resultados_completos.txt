üìÅ Verificando rutas de m√≥dulos...
   ML path exists: True
   Data structures path exists: True
   Util path exists: True
   __init__.py: ‚úÖ
   __init__.py: ‚úÖ
   standard_data_structures.py: ‚úÖ
   fast_ewma.py: ‚úÖ
   Current working directory: /workspaces/Sistema-de-datos/Quant
   Python path entries: 8
üõ¢Ô∏è  DEMO PR√ÅCTICO - AN√ÅLISIS DE WTI CRUDE OIL
============================================================

üìä 1. CARGANDO DATOS DE WTI CRUDE OIL...
   Leyendo archivo Excel WTI Daily con estructura correcta...
‚úÖ Datos hist√≥ricos cargados: 10649 registros
   Columnas encontradas: ['Exchange Date', 'Close', 'Net', '%Chg', 'Open', 'Low', 'High', 'Volume', 'OI', 'O-C', 'H-L', '%CVol', '%COI', 'Bid', 'Ask', 'Trade Price', 'VWAP', 'Block Volume', 'Mid Price', 'Open Interest', 'Lower Limit', 'Upper Limit', 'Settlement Price', 'Expiry Date', 'Last Trade Price', 'Contract Month', 'Settle Net Change', 'Settle Change - Percent', 'Market Open Interest', 'Market Volume']

üìà Muestra de datos hist√≥ricos:
  Exchange Date  Close  ...  Market Open Interest  Market Volume
0    2025-06-26  65.21  ...                   NaN            NaN
1    2025-06-25  64.92  ...                   NaN            NaN
2    2025-06-24  64.37  ...             1961998.0      1478693.0
3    2025-06-23  68.51  ...             1980166.0      1907571.0
4    2025-06-20  74.93  ...             1958208.0      1889787.0

[5 rows x 30 columns]

üîç Informaci√≥n de columnas:
   Col 0: 'Exchange Date' | Ejemplo: 2025-06-26 00:00:00
   Col 1: 'Close' | Ejemplo: 65.21
   Col 2: 'Net' | Ejemplo: 0.289999999999992
   Col 3: '%Chg' | Ejemplo: 0.00446703635243364
   Col 4: 'Open' | Ejemplo: 64.98
   Col 5: 'Low' | Ejemplo: 64.94
   Col 6: 'High' | Ejemplo: 65.3
   Col 7: 'Volume' | Ejemplo: 2189.0
   Col 8: 'OI' | Ejemplo: 292144.0
   Col 9: 'O-C' | Ejemplo: 0.22999999999999
   Col 10: 'H-L' | Ejemplo: 0.359999999999999
   Col 11: '%CVol' | Ejemplo: -0.995957338750635
   Col 12: '%COI' | Ejemplo: -0.0484683657682599
   Col 13: 'Bid' | Ejemplo: 65.2
   Col 14: 'Ask' | Ejemplo: 65.21
   Col 15: 'Trade Price' | Ejemplo: 65.21
   Col 16: 'VWAP' | Ejemplo: 65.19178
   Col 17: 'Block Volume' | Ejemplo: 2364.0
   Col 18: 'Mid Price' | Ejemplo: 65.205
   Col 19: 'Open Interest' | Ejemplo: 292144.0
   Col 20: 'Lower Limit' | Ejemplo: 0.01
   Col 21: 'Upper Limit' | Ejemplo: 65.3
   Col 22: 'Settlement Price' | Ejemplo: 65.21
   Col 23: 'Expiry Date' | Ejemplo: 45860.0
   Col 24: 'Last Trade Price' | Ejemplo: 65.21
   Col 25: 'Contract Month' | Ejemplo: 202508.0
   Col 26: 'Settle Net Change' | Ejemplo: 0.55
   Col 27: 'Settle Change - Percent' | Ejemplo: 0.8544
   Col 28: 'Market Open Interest' | Ejemplo: 1961998.0
   Col 29: 'Market Volume' | Ejemplo: 1478693.0
   Per√≠odo: 2025-06-26 00:00:00 a 1983-03-30 00:00:00
‚úÖ Datos diarios cargados: 10672 registros

üîß 2. PREPARANDO DATOS...
   Mapeando columnas del Excel...
   Columnas originales: ['Exchange Date', 'Close', 'Net', '%Chg', 'Open', 'Low', 'High', 'Volume', 'OI', 'O-C', 'H-L', '%CVol', '%COI', 'Bid', 'Ask', 'Trade Price', 'VWAP', 'Block Volume', 'Mid Price', 'Open Interest', 'Lower Limit', 'Upper Limit', 'Settlement Price', 'Expiry Date', 'Last Trade Price', 'Contract Month', 'Settle Net Change', 'Settle Change - Percent', 'Market Open Interest', 'Market Volume']
   Columnas disponibles: ['Exchange Date', 'Close', 'Net', '%Chg', 'Open', 'Low', 'High', 'Volume']
   ‚úÖ Timestamp creado desde Exchange Date
   ‚úÖ Open convertido a num√©rico
   ‚úÖ High convertido a num√©rico
   ‚úÖ Low convertido a num√©rico
   ‚úÖ Close convertido a num√©rico
   ‚úÖ Volume convertido a num√©rico
   Columnas renombradas: ['date', 'close', 'net_change', 'pct_change', 'open', 'low', 'high', 'volume', 'OI', 'O-C', 'H-L', '%CVol', '%COI', 'Bid', 'Ask', 'Trade Price', 'VWAP', 'Block Volume', 'Mid Price', 'Open Interest', 'Lower Limit', 'Upper Limit', 'Settlement Price', 'Expiry Date', 'Last Trade Price', 'Contract Month', 'Settle Net Change', 'Settle Change - Percent', 'Market Open Interest', 'Market Volume']
   Rango de precios close: $-37.63 - $145.29
   Rango de volumen: 0 - 1774383
   Usando √∫ltimos 500 registros para demo
   Columnas de precio v√°lidas: ['open', 'high', 'low', 'close']
   Columna de volumen: volume

‚úÖ Datos preparados correctamente

üèóÔ∏è  3. PROBANDO M√ìDULOS DATA_STRUCTURES...
‚úÖ M√≥dulos data_structures importados correctamente
   Datos para an√°lisis: 498 puntos
   Rango de precios: $25.18 - $32.20
   Volumen promedio: 2203
   Volumen real: ‚úÖ

üïê 3.1 RESUMEN DE DATOS TEMPORALES...
‚úÖ Datos temporales analizados: 498 registros
   Per√≠odo: 1985-03-26 00:00:00 a 1983-03-30 00:00:00
   Retorno promedio: 0.0093%
   Volatilidad: 0.7337%

üì¶ 3.2 Construyendo VOLUME BARS...
Processing batch with 498 rows...
Generated 19 bars from batch
Generated 19 total bars
‚úÖ Volume bars creadas: 19 barras
   Umbral de volumen: 54,850
   date_time   open   high  ...  cum_buy_volume       vwap  num_ticks
0 1985-03-12  28.45  28.98  ...         29104.0  28.393803         11
1 1985-02-26  28.45  28.98  ...         57926.0  27.831756         21
2 1985-02-12  28.45  28.98  ...         96259.0  27.638433         30

[3 rows x 9 columns]

üí∞ 3.3 Construyendo DOLLAR BARS...
Processing batch with 498 rows...
Generated 14 bars from batch
Generated 14 total bars
‚úÖ Dollar bars creadas: 14 barras
   Threshold de dollars: $2,073,301
   date_time   open   high  ...  cum_buy_volume       vwap  num_ticks
0 1985-03-06  28.45  28.98  ...         38824.0  28.272199         15
1 1985-02-19  28.45  28.98  ...         86260.0  27.632759         26
2 1985-01-31  28.45  28.98  ...        115421.0  27.420854         38

[3 rows x 9 columns]

üìä 3.4 Construyendo TICK BARS...
Processing batch with 498 rows...
Generated 26 bars from batch
Generated 26 total bars
‚úÖ Tick bars creadas: 26 barras
   Umbral de ticks: 19
   date_time   open   high  ...  cum_buy_volume       vwap  num_ticks
0 1985-02-28  28.45  28.98  ...         47206.0  28.013756         19
1 1985-01-31  28.45  28.98  ...        115421.0  27.420854         38
2 1985-01-04  28.45  28.98  ...        176864.0  26.812870         57

[3 rows x 9 columns]

üõ†Ô∏è  4. PROBANDO M√ìDULOS UTIL...
‚úÖ M√≥dulos util importados correctamente
   EWMA: Using optimized Numba JIT compilation for maximum performance

üìà 4.1 AN√ÅLISIS DE VOLATILIDAD...
‚úÖ Volatilidad diaria calculada: 497 valores
   Volatilidad actual: 0.1092
   Volatilidad promedio: 0.1095
‚úÖ Volatilidad Garman-Klass: 0.1028
‚úÖ Volatilidad Yang-Zhang: 0.1604

‚ö° 4.2 AN√ÅLISIS EWMA...
‚úÖ EWMA b√°sico calculado: √∫ltimo valor $30.13
‚úÖ EWMA vectorizado: √∫ltimo valor $30.13
‚ùå Error en EWMA: Failed in nopython mode pipeline (step: nopython frontend)
Cannot infer the type of variable '$158build_list.3' (temporary variable), have imprecise type: list(undefined)<iv=None>. 

For Numba to be able to compile a list, the list must have a known and
precise type that can be inferred from the other variables. Whilst sometimes
the type of empty lists can be inferred, this is not always the case, see this
documentation for help:

https://numba.readthedocs.io/en/stable/user/troubleshoot.html#my-code-has-an-untyped-list-problem


File "Machine Learning/util/fast_ewma.py", line 120:
    def ewma_alpha(arr_in, alpha):  # pragma: no cover
        <source elided>
        if len(arr_in) == 0:
            return np.array([], dtype=np.float64)
            ^

During: Pass nopython_type_inference

üìä 4.3 CLASIFICACI√ìN DE VOLUMEN...
‚úÖ BVC calculado: 498 valores
   Ratio de compra BVC: 0.458
‚úÖ Tick Rule calculado: ratio de compra 0.551
   Diferencia entre m√©todos: 0.093

üîß 4.4 UTILIDADES MISCEL√ÅNEAS...
‚úÖ DataFrame segmentado en 4 chunks de ~25 filas
‚úÖ Winsorizaci√≥n aplicada: 49 outliers suavizados
‚úÖ Particiones para multiproceso: [  0 125 249 374 498]
‚úÖ Dataset sint√©tico generado: X(100, 5), y(100,)

üìä 5. GENERANDO VISUALIZACIONES...
‚úÖ Gr√°ficos guardados en: /workspaces/Sistema-de-datos/Quant/demo_wti_analysis.png

============================================================
üìã RESUMEN DEL DEMO PR√ÅCTICO
============================================================

üìä DATOS PROCESADOS:
   ‚Ä¢ Dataset: WTI Crude Oil
   ‚Ä¢ Registros analizados: 500
   ‚Ä¢ Per√≠odo: 1985-03-26 00:00:00 a 1983-03-30 00:00:00
   ‚Ä¢ Rango de precios: $25.18 - $32.20

üèóÔ∏è  M√ìDULOS DATA_STRUCTURES:
   ‚úÖ Volume Bars (19 barras)
   ‚úÖ Dollar Bars (14 barras)
   ‚úÖ Tick Bars (26 barras)

üõ†Ô∏è  M√ìDULOS UTIL:
   ‚úÖ Volatilidad (√∫ltimo: 0.1092)
   ‚úÖ EWMA (√∫ltimo: $30.13)
   ‚úÖ Clasificaci√≥n Volumen (ratio compra: 0.458)

‚ö° PERFORMANCE:
   ‚úÖ EWMA: Using optimized Numba JIT compilation for maximum performance
   ‚úÖ Todas las funciones ejecutadas sin errores cr√≠ticos
   ‚úÖ M√≥dulos optimizados funcionando correctamente

üéâ DEMO COMPLETADO EXITOSAMENTE!
   Los m√≥dulos data_structures y util est√°n funcionando
   correctamente con datos reales de WTI Crude Oil.
============================================================
